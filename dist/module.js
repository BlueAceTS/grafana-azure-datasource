define(["react","@grafana/ui","lodash","@grafana/data","@grafana/runtime"],(function(e,t,r,n,a){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=5)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t,r){"use strict";r.r(t);var n=r(3),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function i(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new r((function(t){t(e.value)})).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var l=r(2),c=function(e){this.id="",this.subscriptionId="",this.tenantId="",this.displayName="",this.name="",e&&(this.id=e.id||e.subscriptionId,this.subscriptionId=e.subscriptionId||e.id,this.tenantId=e.tenantId,this.displayName=e.displayName,this.name=e.name||e.displayName||"")},p=r(4),m=function e(t,r){return void 0===r&&(r=1),Object(p.getBackendSrv)().datasourceRequest(t).catch((function(n){return r>0?e(t,r-1):(console.error("Error while retreiving data from "+t.url,n),{})}))},f=function(){function e(e){this.instanceSettings=e,this.subscriptions=[],this.baseUrl=e.url,this.cloudName=e.jsonData.cloudName||"azuremonitor"}return e.$inject=["instanceSettings"],e.prototype.getSubscriptions=function(){return s(this,void 0,void 0,(function(){var e,t=this;return u(this,(function(r){return this.subscriptions.length>0?[2,new Promise((function(e){e(t.subscriptions)}))]:(e={method:"GET",url:this.baseUrl+"/"+this.cloudName+"/subscriptions?api-version=2018-01-01"},[2,m(e,2).then((function(e){return e&&200===e.status&&e.data&&e.data.value?(t.subscriptions=(e.data.value||[]).map((function(e){return new c(e)})),t.subscriptions):(console.error("Invalid response received for getSubscriptions query",e),t.subscriptions)})).catch((function(e){return console.error(e),t.subscriptions}))])}))}))},e}(),h=function(e,t){this.refId=e,this.query=t},d=function(e,t){return e=(e||[]).map((function(e,t){return e.text=e.name||t,e.type="integer"===e.type?"number":e.type||"string",e})),t=(t||[]).map((function(t){return t.map((function(t,r){return e[r]&&"number"===e[r].type?+t:"string"==typeof t?t:JSON.stringify(t)}))})),{columns:e,rows:t,type:"table"}},g=function(e){var t=[];return e&&e.rows&&e.rows.forEach((function(e){if(2===e.length){var r=e[0],n=e[1];t.push({text:r,value:n})}else e.forEach((function(e){var r=e,n=e;t.push({text:r,value:n})}))})),t},y=function(e){var t=e[0]||{};return t.rows=Object(l.uniq)(Object(l.flatten)(e.map((function(e){return e.rows})))),t},v=function(e){var t,r,n=this;this.output={columns:[],refId:"",rows:[],type:"table"},r=[],e.forEach((function(e){e.result&&e.result.data&&e.result.data.tables?(e.result.data.tables||[]).forEach((function(e){e.columns&&3===e.columns.length&&e.columns.find((function(e){return"datetime"===e.type}))&&e.columns.find((function(e){return"string"===e.type}))&&e.columns.find((function(e){return"long"===e.type}))?r.push("time_series"):e.columns&&2===e.columns.length&&e.columns.find((function(e){return"datetime"===e.type}))&&e.columns.find((function(e){return"long"===e.type}))?r.push("time_series"):r.push("table")})):e.result&&e.result.data&&e.result.data.data&&r.push("table")})),Object(l.every)(r,(function(e){return"time_series"===e}))?(this.output.type="time_series",this.output=(t=[],e.forEach((function(e){e.result&&e.result.data&&e.result.data.tables&&(e.result.data.tables||[]).forEach((function(e){var r=function(e){var t={};return e.columns.forEach((function(e,r){"datetime"===e.type?(t.timestamp={},t.timestamp.name=e.name,t.timestamp.index=r):"string"===e.type?(t.metricname={},t.metricname.name=e.name,t.metricname.index=r):"long"===e.type&&(t.value={},t.value.name=e.name,t.value.index=r)})),function(e){return!(e.columns&&e.columns.length>=3&&e.columns.find((function(e){return"datetime"===e.type}))&&e.columns.find((function(e){return"string"===e.type}))&&e.columns.find((function(e){return"long"===e.type}))||(e.columns&&e.columns.length>=2&&e.columns.find((function(e){return"datetime"===e.type}))&&e.columns.find((function(e){return"long"===e.type})),0))}(e)&&(t.metricname={},t.metricname.name=t.value.name||"metric",t.metricname.index=-1),t}(e);if(-1===r.metricname.index){var n={};n.target=r.value.name,n.datapoints=[],e.rows.forEach((function(e){n.datapoints.push([e[r.value.index],new Date(e[r.timestamp.index]).getTime()])})),t.push(n)}else Object(l.uniq)(e.rows.map((function(e){return e[r.metricname.index]}))).forEach((function(n){var a={};a.target=n,a.datapoints=[],e.rows.forEach((function(e){e[r.metricname.index]===n&&a.datapoints.push([e[r.value.index],new Date(e[r.timestamp.index]).getTime()])})),t.push(a)}))}))})),t),this.output=this.output.map((function(e){return e.datapoints=Object(l.sortBy)(e.datapoints,[function(e){return e[1]}]),e}))):(this.output.type="table",e.forEach((function(e){if(e.result&&e.result.data&&e.result.data.tables)(t=e.result.data.tables||[]).forEach((function(t){var r=d(t.columns,t.rows);n.output.columns=r.columns,n.output.rows=[].concat(n.output.rows,r.rows),n.output.refId=e.query.refId}));else if(e.result&&e.result.data&&e.result.data.data){var t=e.result.data.data||{},r=d(t.columns,t.rows);n.output.columns=r.columns,n.output.rows=[].concat(n.output.rows,r.rows),n.output.refId=e.query.refId}})))},C=r(0),b=r.n(C),A=r(1),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onResourceGraphQueryChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureResourceGraph;s.query=r,i(o(o({},a),{azureResourceGraph:s}))},t.onResourceGraphTopChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureResourceGraph;s.top=r,i(o(o({},a),{azureResourceGraph:s}))},t.onResourceGraphSkipChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureResourceGraph;s.skip=r,i(o(o({},a),{azureResourceGraph:s}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",null,b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Resource Graph Query"},"Query"),b.a.createElement("textarea",{value:e.azureResourceGraph.query||"",onChange:this.onResourceGraphQueryChange,className:"gf-form-input min-width-30 width-30",rows:10})))),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormField,{label:"Top",labelWidth:12,inputWidth:9,onChange:this.onResourceGraphTopChange,value:e.azureResourceGraph.top,placeholder:"1000",tooltip:"Top N Results. Default / Max is 1000"}),b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"width-1"})),b.a.createElement(A.FormField,{label:"Skip",labelWidth:12,inputWidth:9,onChange:this.onResourceGraphSkipChange,value:e.azureResourceGraph.skip,placeholder:"0",tooltip:"Skip N Results. Default 0"}))))))},t}(C.PureComponent),w={query:"",top:1e3,skip:0},E=function(e){function t(t,r,n,a,i){void 0===t&&(t=""),void 0===r&&(r=""),void 0===n&&(n=1e3),void 0===a&&(a=0),void 0===i&&(i=[]);var o=e.call(this,t,r)||this;return o.top=n,o.skip=a,o.subscriptions=i,o}return i(t,e),t}(h),z=function(){function e(e,t){this.azureConnection=e,this.templateSrv=t,this.allSubscriptions=[],this.url=e.instanceSettings.url,this.baseUrl="/"+e.instanceSettings.jsonData.cloudName}return e.$inject=["azureConnection","templateSrv"],e.prototype.doResourceGraphRequest=function(e,t){return void 0===t&&(t=1),s(this,void 0,void 0,(function(){var r,n,a,i;return u(this,(function(o){switch(o.label){case 0:return r=[],0!==this.allSubscriptions.length?[3,2]:(n=this,[4,this.azureConnection.getSubscriptions()]);case 1:n.allSubscriptions=o.sent(),o.label=2;case 2:return r=this.allSubscriptions.map((function(e){return e.subscriptionId.toString()})),e.subscriptions.indexOf("all")<0&&(a=e.subscriptions.filter((function(e){return"all"!==e}))).length>0&&(r=a),i={data:{options:{$skip:e.skip||0,$top:e.top||100,resultFormat:"table"},query:e.query,subscriptions:r},headers:{"Content-Type":"application/json"},method:"POST",url:this.url+this.baseUrl+"/providers/Microsoft.ResourceGraph/resources?api-version=2019-04-01"},[2,m(i,t)]}}))}))},e.prototype.doQueries=function(e){var t=this;return e.map((function(e){return t.doResourceGraphRequest(e).then((function(t){return{result:t,query:e}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.query=function(e){return s(this,void 0,void 0,(function(){var t,r,n=this;return u(this,(function(a){return(t=e.targets.filter((function(e){return!0!==e.hide&&e.azureResourceGraph&&e.azureResourceGraph.query})).map((function(t){var r=t.azureResourceGraph;return new E(t.refId,n.templateSrv.replace(r.query,e.scopedVars),r.top||1e3,r.skip||0,r.subscriptions||["all"])})))&&0!==t.length?(r=this.doQueries(t),[2,Promise.all(r).then((function(e){return new v(e).output}))]):[2]}))}))},e.prototype.simpleQuery=function(e,t,r,n,a){if(void 0===t&&(t="SimpleQuery"),void 0===r&&(r=1e3),void 0===n&&(n=0),void 0===a&&(a=["all"]),e){var i=[new E(t,e,r,n,a)],o=this.doQueries(i);return Promise.all(o).then((function(e){return new v(e).output}))}},e.prototype.batchQuery=function(e,t,r,n){return void 0===r&&(r=[]),void 0===n&&(n=0),s(this,void 0,void 0,(function(){var a;return u(this,(function(i){switch(i.label){case 0:return[4,this.simpleQuery(e,"",1e3,n)];case 1:return a=i.sent(),r.push(a),t>0&&a&&a.rows&&a.rows.length>=1e3?[4,this.batchQuery(e,t-1,r,n+1e3)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2,y(r)]}}))}))},e.prototype.metricFindQuery=function(e,t){if(void 0===t&&(t="MetricFindQuery"),e.startsWith("ResourceGraph(")&&e.endsWith(")")){var r=e.replace("ResourceGraph(","").slice(0,-1),n=new E(t,this.templateSrv.replace(r),1e3,0,["all"]),a=this.doQueries([n]);return Promise.all(a).then((function(e){var t=new v(e);return g(t.output)}))}if(e.startsWith("Subscriptions(")&&e.endsWith(")")){r='resourcecontainers | where type == "microsoft.resources/subscriptions" | distinct name, subscriptionId | order by name asc',n=new E(t,this.templateSrv.replace(r),1e3,0,["all"]),a=this.doQueries([n]);return Promise.all(a).then((function(e){var t=new v(e);return g(t.output)}))}if(e.startsWith("ResourceGroups(")&&e.endsWith(")")){var i=e.replace("ResourceGroups(","").slice(0,-1);r="";r=i?'resourcecontainers | where type != "microsoft.resources/subscriptions" and subscriptionId == "'+i+'" | distinct name | order by name asc':'resourcecontainers | where type != "microsoft.resources/subscriptions" | distinct name | order by name asc';n=new E(t,this.templateSrv.replace(r),1e3,0,["all"]),a=this.doQueries([n]);return Promise.all(a).then((function(e){var t=new v(e);return g(t.output)}))}},e}(),S=function(e,t,r,n,a){if(void 0===e&&(e=""),void 0===t&&(t=""),void 0===r&&(r=""),void 0===n&&(n=""),void 0===a&&(a=""),this.id="",this.subscriptionId="",this.resourceGroup="",this.type="",this.name="",e){var i=e.split("/");this.id=e,this.subscriptionId=i[2],this.resourceGroup=i[4],this.type=i.filter((function(e,t){return e&&t>=6&&t!==i.length-1})).join("/"),this.name=i[i.length-1]}else r&&n&&a&&(this.id="/subscriptions/"+t+"/resourceGroups/"+r+"/providers/"+n+"/"+a)},X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAppInsightsAppIDChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureAppInsights;s.appInsightsAppId=r,i(o(o({},a),{azureAppInsights:s}))},t.onAppInsightsQueryChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureAppInsights;s.query=r,i(o(o({},a),{azureAppInsights:s}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormField,{label:"Application Insights ID",labelWidth:12,inputWidth:24,onChange:this.onAppInsightsAppIDChange,value:e.azureAppInsights.appInsightsAppId||"",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",tooltip:"AppInsights ID"})))),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Application Insights Query"},"Query"),b.a.createElement("textarea",{value:e.azureAppInsights.query||"",onChange:this.onAppInsightsQueryChange,className:"gf-form-input min-width-30 width-30",rows:10})))))},t}(C.PureComponent),q={appInsightsAppId:"",query:""},I=function(e){function t(t,r,n,a){void 0===t&&(t=""),void 0===r&&(r=""),void 0===n&&(n=""),void 0===a&&(a="");var i=e.call(this,t,a)||this;return i.resourceId=r,i.resource=new S(r),i.appInsightsAppId=n,i.query=a,i}return i(t,e),t}(h),F=function(){function e(e,t){this.azureConnection=e,this.templateSrv=t,this.url=this.azureConnection.instanceSettings.url,this.baseUrl="/"+this.azureConnection.instanceSettings.jsonData.cloudName}return e.$inject=["azureConnection","templateSrv"],e.prototype.doApplicationInsightsRequest=function(e,t){return void 0===t&&(t=1),s(this,void 0,void 0,(function(){var r;return u(this,(function(n){return r={data:{query:e.query},headers:{"Content-Type":"application/json"},method:"POST",url:this.url+this.baseUrl+e.resourceId+"/query?api-version=2018-04-20"},e.appInsightsAppId&&(r.url=this.url+"/applicationinsights/v1/apps/"+e.appInsightsAppId+"/query?api-version=2018-04-20"),[2,m(r,t)]}))}))},e.prototype.doQueries=function(e){var t=this;return e.map((function(e){return t.doApplicationInsightsRequest(e).then((function(t){return{result:t,query:e}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.query=function(e){return s(this,void 0,void 0,(function(){var t,r,n=this;return u(this,(function(a){return(t=e.targets.filter((function(e){var t=e.azureAppInsights;return!0!==e.hide&&t&&t.query&&(t.resourceId||t.appInsightsAppId)})).map((function(t){var r=t.azureAppInsights;return new I(t.refId,n.templateSrv.replace(r.resourceId,e.scopedVars),n.templateSrv.replace(r.appInsightsAppId,e.scopedVars),n.templateSrv.replace(r.query,e.scopedVars))})))&&0!==t.length?(r=this.doQueries(t),[2,Promise.all(r).then((function(e){return new v(e).output}))]):[2]}))}))},e.prototype.metricFindQuery=function(e){},e}(),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onLAWorkspaceIDChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureLogAnalytics;s.workspace=r,i(o(o({},a),{azureLogAnalytics:s}))},t.onLAQueryChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureLogAnalytics;s.query=r,i(o(o({},a),{azureLogAnalytics:s}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormField,{label:"Workspace ID",labelWidth:12,inputWidth:24,onChange:this.onLAWorkspaceIDChange,value:e.azureLogAnalytics.workspace||"",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",tooltip:"Log Anlaytics workspace ID"})))),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Log Analytics Query"},"Query"),b.a.createElement("textarea",{value:e.azureLogAnalytics.query||"",onChange:this.onLAQueryChange,className:"gf-form-input min-width-30 width-30",rows:10})))))},t}(C.PureComponent),D={workspace:"",query:""},O=function(e){function t(t,r,n,a){void 0===t&&(t=""),void 0===r&&(r=""),void 0===n&&(n=""),void 0===a&&(a="");var i=e.call(this,t,a)||this;return i.resourceId=r,i.resource=new S(r),i.workspace=n,i.query=a,i}return i(t,e),t}(h),j=function(){function e(e,t){this.azureConnection=e,this.templateSrv=t,this.url=this.azureConnection.instanceSettings.url,this.baseUrl="/"+this.azureConnection.instanceSettings.jsonData.cloudName}return e.$inject=["azureConnection","templateSrv"],e.prototype.doLogAnalyticsRequest=function(e,t){return void 0===t&&(t=1),s(this,void 0,void 0,(function(){var r;return u(this,(function(n){return r={data:{query:e.query},headers:{"Content-Type":"application/json"},method:"POST",url:this.url+this.baseUrl+e.resourceId+"/query?api-version=2017-10-01"},e.workspace&&(r.url=this.url+"/loganalytics/v1/workspaces/"+e.workspace+"/query?api-version=2017-10-01"),[2,m(r,t)]}))}))},e.prototype.doQueries=function(e){var t=this;return e.map((function(e){return t.doLogAnalyticsRequest(e).then((function(t){return{result:t,query:e}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.query=function(e){return s(this,void 0,void 0,(function(){var t,r,n=this;return u(this,(function(a){return(t=e.targets.filter((function(e){var t=e.azureLogAnalytics;return!0!==e.hide&&t&&t.query&&(t.resourceId||t.workspace)})).map((function(t){var r=t.azureLogAnalytics;return new O(t.refId,n.templateSrv.replace(r.resourceId,e.scopedVars),n.templateSrv.replace(r.workspace,e.scopedVars),n.templateSrv.replace(r.query,e.scopedVars))})))&&0!==t.length?(r=this.doQueries(t),[2,Promise.all(r).then((function(e){return new v(e).output}))]):[2]}))}))},e.prototype.metricFindQuery=function(e){},e}(),R=function(e,t,r){var n=2,a="";if(this.timestamp=new Date,this.cost=e[0],"None"===r.granularity)this.timestamp=new Date(r.query.range.from),n--;else if("Daily"===r.granularity){var i=e[2].toString(),o=i.substring(0,4),s=i.substring(4,6),u=i.substring(6,8);this.timestamp=new Date(o,s-1,u)}else"Monthly"===r.granularity&&(this.timestamp=new Date(e[2]));a=r.data.dataSet.grouping?r.data.dataSet.grouping[0]&&"TagKey"===r.data.dataSet.grouping[0].type?e.filter((function(t,r){return r<e.length-1&&r>n+1})).map((function(e){return e||"-"})).join(":").trim():e.filter((function(t,r){return r<e.length-1&&r>n})).map((function(e){return e||"-"})).join(":").trim():"cost",this.label=a,r.rawquery.alias&&"{{default}}"!==r.rawquery.alias&&(r.rawquery.alias.indexOf("{{default}}")>-1||"cost"===this.label)&&(this.label=r.rawquery.alias,this.label=this.label.replace(/{{default}}/g,a),this.label=this.label.replace(/{{metric}}/g,a),this.label=this.label.replace(/{{subscription}}/g,r.rawquery.subscriptionName||r.rawquery.subscriptionId),this.label=this.label.replace(/{{subscriptionname}}/g,r.rawquery.subscriptionName||r.rawquery.subscriptionId),this.label=this.label.replace(/{{subscriptionid}}/g,r.rawquery.subscriptionId))},G=function(e){var t=this;this.output=[];var r=[];e.forEach((function(e){e&&e.result&&e.result.data&&e.result.data.properties&&e.result.data.properties.rows&&e.result.data.properties.rows.forEach((function(t){r.push(new R(t,e.result.data.properties.columns,e.query))}))})),Object(l.uniq)(r.map((function(e){return e.label}))).forEach((function(e){var n={target:e||"-",datapoints:[]};n.datapoints=r.filter((function(t){return t.label===e})).map((function(e){return[e.cost,e.timestamp]})).sort((function(e,t){return e[1]-t[1]})),t.output.push(n)})),this.output=this.output.sort((function(e,t){return t.target-e.target}))},x=[{value:"None",label:"None"},{value:"Daily",label:"Daily"},{value:"Monthly",label:"Monthly"}],P=[{value:"None",label:"None"},{value:"Dimension",label:"Dimension"},{value:"TagKey",label:"Tag"}],k=[{value:"ResourceId",label:"Resource"},{value:"ResourceType",label:"Resource Type"},{value:"ResourceLocation",label:"Resource Location"},{value:"ResourceGroupName",label:"Resource Group Name"},{value:"ServiceName",label:"Service Name"},{value:"ServiceTier",label:"Service Tier"},{value:"Meter",label:"Meter"},{value:"MeterCategory",label:"Meter Category"},{value:"MeterSubCategory",label:"Meter SubCategory"},{value:"PricingModel",label:"Pricing Model"},{value:"PublisherType",label:"Publisher Type"},{value:"ChargeType",label:"Charge Type"}],L=[{value:"None",label:"None"},{value:"Dimensions",label:"Dimensions"},{value:"Tags",label:"Tags"}],Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=Object(l.defaults)(t.state,{AzureSubscriptions:[]}),t.onACASubscriptionIDChange=function(e){var r=e.value,n=t.props,a=n.query,i=n.onChange,s=a.azureCostAnalysis;s.subscriptionId=r,s.subscriptionName=e.label,i(o(o({},a),{azureCostAnalysis:s}))},t}return i(t,e),t.prototype.componentWillMount=function(){var e=this;0===this.state.AzureSubscriptions.length&&new f(this.props.datasource.instanceSettings).getSubscriptions().then((function(t){e.setState({AzureSubscriptions:t.map((function(e){return{value:e.subscriptionId,label:e.name}}))})}))},t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Subscription"},"Subscription"),b.a.createElement(A.Select,{className:"width-24",value:this.state.AzureSubscriptions.find((function(t){return t.value===e.azureCostAnalysis.subscriptionId}))||{label:e.azureCostAnalysis.subscriptionId,value:e.azureCostAnalysis.subscriptionId},allowCustomValue:!0,options:this.state.AzureSubscriptions,defaultValue:e.azureCostAnalysis.subscriptionId,onChange:this.onACASubscriptionIDChange}))))},t}(C.PureComponent),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onACAGranularityChange=function(e){var r=t.props,n=r.query,a=r.onChange,i=n.azureCostAnalysis;i.granularity=e.value,a(o(o({},n),{azureCostAnalysis:i}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Granularity"}," ","Granularity"),b.a.createElement(A.Select,{className:"width-24",value:x.find((function(t){return t.value===e.azureCostAnalysis.granularity})),options:x,defaultValue:e.azureCostAnalysis.granularity,onChange:this.onACAGranularityChange}))))},t}(C.PureComponent),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onACAGroupingTypeChange=function(e){var r=e.value,n=t.props,a=n.query,i=n.onChange,s=a.azureCostAnalysis;s.grouping=s.grouping||{type:"Dimension",name:"ServiceName"},s.grouping[0].type=r,i(o(o({},a),{azureCostAnalysis:s}))},t.onACAGroupingNameChange=function(e){var r=e.target.value,n=t.props,a=n.query,i=n.onChange,s=a.azureCostAnalysis;s.grouping=s.grouping||{type:"Dimension",name:"ServiceName"},s.grouping[0].name=r,i(o(o({},a),{azureCostAnalysis:s}))},t.onACAGroupingNameChangeDimension=function(e){var r=e.value,n=t.props,a=n.query,i=n.onChange,s=a.azureCostAnalysis;s.grouping=s.grouping||{type:"Dimension",name:"ServiceName"},s.grouping[0].name=r,i(o(o({},a),{azureCostAnalysis:s}))},t}return i(t,e),t.prototype.render=function(){var e,t=this.props.query;return e="TagKey"===t.azureCostAnalysis.grouping[0].type?b.a.createElement("div",null,b.a.createElement(A.FormField,{label:"Tag Name",labelWidth:12,inputWidth:12,onChange:this.onACAGroupingNameChange,value:t.azureCostAnalysis.grouping[0].name,placeholder:"Tag Name",tooltip:"Tag Name"})):"Dimension"===t.azureCostAnalysis.grouping[0].type?b.a.createElement("span",null,b.a.createElement(A.Select,{className:"width-12",value:k.find((function(e){return e.value===t.azureCostAnalysis.grouping[0].name})),options:k,defaultValue:t.azureCostAnalysis.grouping[0].name,onChange:this.onACAGroupingNameChangeDimension})):b.a.createElement("div",null),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Group by"},"Group by"),b.a.createElement(A.Select,{className:"width-12",value:P.find((function(e){return e.value===t.azureCostAnalysis.grouping[0].type})),options:P,defaultValue:t.azureCostAnalysis.grouping[0].type,onChange:this.onACAGroupingTypeChange}),b.a.createElement("span",null,e))))},t}(C.PureComponent),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onACAFilteAdd=function(){var e=t.props,r=e.query,n=e.onChange,a=r.azureCostAnalysis;a.filters=a.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],a.filters.push({FilterType:"None",Name:"None",Operator:"In",Values:[]}),n(o(o({},r),{azureCostAnalysis:a}))},t.onACAFilterRemove=function(e){var r=t.props,n=r.query,a=r.onChange,i=n.azureCostAnalysis;i.filters=i.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],i.filters.splice(e,1),a(o(o({},n),{azureCostAnalysis:i}))},t.onACAFilterTypeChange=function(e,r){var n=e.value,a=t.props,i=a.query,s=a.onChange,u=i.azureCostAnalysis;u.filters=u.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],u.filters[r].FilterType=n,s(o(o({},i),{azureCostAnalysis:u}))},t.onACAFilterNameChange=function(e,r){var n=e.target.value,a=t.props,i=a.query,s=a.onChange,u=i.azureCostAnalysis;u.filters=u.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],u.filters[r].Name=n,s(o(o({},i),{azureCostAnalysis:u}))},t.onACAFilterNameChangeDimension=function(e,r){var n=e.value,a=t.props,i=a.query,s=a.onChange,u=i.azureCostAnalysis;u.filters=u.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],u.filters[r].Name=n,s(o(o({},i),{azureCostAnalysis:u}))},t.onACAFilterOperatorChange=function(e,r){var n=e.target.value,a=t.props,i=a.query,s=a.onChange,u=i.azureCostAnalysis;u.filters=u.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],u.filters[r].Operator=n,s(o(o({},i),{azureCostAnalysis:u}))},t.onACAFilterValueChange=function(e,r){var n=e.target.value,a=t.props,i=a.query,s=a.onChange,u=i.azureCostAnalysis;u.filters=u.filters||[{FilterType:"None",Name:"None",Operator:"In",Values:[]}],u.filters[r].Values=n.split(","),s(o(o({},i),{azureCostAnalysis:u}))},t}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return b.a.createElement("div",null,0===t.azureCostAnalysis.filters.length?b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Filter"},"Filter"))),b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:this.onACAFilteAdd},"Add Filter")))):null,t.azureCostAnalysis.filters.map((function(t,r){return b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Filter"},"Filter ",r+1))),b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Select,{className:"width-12",value:L.find((function(e){return e.value===t.FilterType})),options:L,defaultValue:t.FilterType,onChange:function(t){return e.onACAFilterTypeChange(t,r)}}))),b.a.createElement("div",null,"None"===t.FilterType?b.a.createElement("span",null,b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:e.onACAFilteAdd},"+"),b.a.createElement("span",{className:"btn btn-danger btn-small",style:{margin:"5px"},onClick:function(){return e.onACAFilterRemove(r)}},"x")))):null,"Dimensions"===t.FilterType?b.a.createElement("span",null,b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Select,{className:"width-12",value:k.find((function(e){return e.value===t.Name})),options:k,defaultValue:t.Name,onChange:function(t){return e.onACAFilterNameChangeDimension(t,r)}})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Input,{type:"text",className:"width-12",title:"Operator",placeholder:"Operator",value:t.Operator,onChange:function(t){return e.onACAFilterOperatorChange(t,r)},disabled:!0})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Input,{type:"text",className:"width-12",title:"Values; Comma seperated",placeholder:"Values",value:t.Values.join(","),onChange:function(t){return e.onACAFilterValueChange(t,r)}})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:e.onACAFilteAdd},"+"),b.a.createElement("span",{className:"btn btn-danger btn-small",style:{margin:"5px"},onClick:function(){return e.onACAFilterRemove(r)}},"x")))):null,"Tags"===t.FilterType?b.a.createElement("span",null,b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Input,{type:"text",className:"width-12",title:"Tag Name",placeholder:"Tag Name",value:t.Name,onChange:function(t){return e.onACAFilterNameChange(t,r)}})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Input,{type:"text",className:"width-12",title:"Operator",placeholder:"Operator",value:t.Operator,onChange:function(t){return e.onACAFilterOperatorChange(t,r)},disabled:!0})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.Input,{type:"text",className:"width-12",title:"Tags; Comma seperated",placeholder:"Tags",value:t.Values.join(","),onChange:function(t){return e.onACAFilterValueChange(t,r)}})),b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:e.onACAFilteAdd},"+"),b.a.createElement("span",{className:"btn btn-danger btn-small",style:{margin:"5px"},onClick:function(){return e.onACAFilterRemove(r)}},"x")))):null))})))},t}(C.PureComponent),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onACAAliasChange=function(e){var r=t.props,n=r.query,a=r.onChange,i=n.azureCostAnalysis;i.alias=e.target.value,a(o(o({},n),{azureCostAnalysis:i}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.query;return b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form gf-form--grow"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Leave blank for default. Or refer as {{default}} for default value"},"Alias"),b.a.createElement(A.Input,{className:"width-24",value:e.azureCostAnalysis.alias,onChange:this.onACAAliasChange}))))},t}(C.PureComponent),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.query,r=e.onChange,n=e.datasource;return b.a.createElement("div",null,b.a.createElement(Q,{query:t,onChange:r,datasource:n}),b.a.createElement(V,{query:t,onChange:r}),b.a.createElement(W,{query:t,onChange:r}),b.a.createElement(M,{query:t,onChange:r}),b.a.createElement(_,{query:t,onChange:r}))},t}(C.PureComponent),$={alias:"",subscriptionId:"",subscriptionName:"",granularity:"Daily",grouping:[{type:"None",name:"None"}],filters:[{FilterType:"None",Name:"None",Operator:"In",Values:[]}]},J=function(e,t){this.type="ActualCost",this.timeframe="Custom",this.timePeriod={from:new Date(e.from).toISOString(),to:new Date(e.to).toISOString()},this.dataSet=t},K=function(e){function t(t,r,n,a){void 0===t&&(t="");var i=e.call(this,t,r)||this;i.scope=a.replace("/subscriptions/"+n.subscriptionId,r.scopedVars),i.granularity=a.replace(n.granularity||"Monthly",r.scopedVars),i.rawquery=n,i.rawquery.alias=a.replace(i.rawquery.alias,r.scopedVars);var o;if(o=n.grouping&&n.grouping.length>0?n.grouping:[{type:"Dimension",name:"ServiceName"}],i.data=new J(r.range,{granularity:i.granularity,aggregation:{totalCost:{name:"PreTaxCost",function:"Sum"},totalCostUSD:{name:"PreTaxCostUSD",function:"Sum"}},sorting:[{direction:"ascending",name:"UsageDate"}],grouping:o}),o&&o.length>0&&"None"===o[0].type&&delete i.data.dataSet.grouping,n.filters=n.filters.filter((function(e){return e&&"None"!==e.FilterType})),n.filters&&n.filters.length>0&&"None"!==n.filters[0].FilterType){if(1===n.filters.length){var s={};s[n.filters[0].FilterType]=n.filters[0],delete s[n.filters[0].FilterType].FilterType,i.data.dataSet.filter=s}else if(n.filters.length>0){var u={And:[]};n.filters.forEach((function(e){var t={};t[e.FilterType]=e,delete t[e.FilterType].FilterType,u.And.push(t)})),i.data.dataSet.filter=u}}else n.filter&&(i.data.dataSet.filter=n.filter);return i}return i(t,e),t}(h),B=function(){function e(e,t){this.azureConnection=e,this.templateSrv=t,this.url=this.azureConnection.instanceSettings.url,this.baseUrl="/"+this.azureConnection.instanceSettings.jsonData.cloudName}return e.$inject=["azureConnection","templateSrv"],e.prototype.doCostRequest=function(e,t){return void 0===t&&(t=1),s(this,void 0,void 0,(function(){var r;return u(this,(function(n){return r={data:e.data,headers:{"Content-Type":"application/json"},method:"POST",url:this.url+this.baseUrl+e.scope+"/providers/Microsoft.CostManagement/query?api-version=2019-11-01&$top=10000"},[2,m(r,t)]}))}))},e.prototype.doQueries=function(e){var t=this;return e.map((function(e){return t.doCostRequest(e).then((function(t){return{result:t,query:e}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.query=function(e){return s(this,void 0,void 0,(function(){var t,r,n=this;return u(this,(function(a){return(t=e.targets.filter((function(e){var t=e.azureCostAnalysis;return!0!==e.hide&&t})).map((function(t){var r=t.azureCostAnalysis;return new K(t.refId,e,r,n.templateSrv)})))&&0!==t.length?(r=this.doQueries(t),[2,Promise.all(r).then((function(e){return new G(e).output}))]):[2]}))}))},e.prototype.metricFindQuery=function(e){},e}(),H=[{value:"Azure Resource Graph",label:"Azure Resource Graph"},{value:"Azure Cost Analysis",label:"Azure Cost Analysis"},{value:"Azure Application Insights",label:"Azure Application Insights - unstable"},{value:"Azure Log Analytics",label:"Azure Log Analytics - unstable"}],Y=[{value:"azuremonitor",label:"Azure"},{value:"govazuremonitor",label:"Azure US Government"},{value:"germanyazuremonitor",label:"Azure Germany"},{value:"chinaazuremonitor",label:"Azure China"}],Z=function(e){function t(t,r){var n=e.call(this,t)||this;n.instanceSettings=t,n.templateSrv=r;var a=new f(n.instanceSettings);return n.azureResourceGraphDatasource=new z(a,n.templateSrv),n.azureApplicationInsightsDatasource=new F(a,n.templateSrv),n.azureLogAnalyticsDatasource=new j(a,n.templateSrv),n.azureConstAnalysisDatasource=new B(a,n.templateSrv),n}return t.$inject=["instanceSettings","templateSrv"],i(t,e),t.prototype.query=function(e){var t=[],r=Object(l.cloneDeep)(e);(r.targets=Object(l.filter)(r.targets,["queryType","Azure Resource Graph"]),r.targets.length>0)&&((a=this.azureResourceGraphDatasource.query(r))&&t.push(a));var n=Object(l.cloneDeep)(e);(n.targets=Object(l.filter)(n.targets,["queryType","Azure Application Insights"]),n.targets.length>0)&&((a=this.azureApplicationInsightsDatasource.query(n))&&t.push(a));var a,i=Object(l.cloneDeep)(e);(i.targets=Object(l.filter)(i.targets,["queryType","Azure Log Analytics"]),i.targets.length>0)&&((a=this.azureLogAnalyticsDatasource.query(i))&&t.push(a));var o=Object(l.cloneDeep)(e);if(o.targets=Object(l.filter)(o.targets,["queryType","Azure Cost Analysis"]),o.targets.length>0){var s=this.azureConstAnalysisDatasource.query(o);s&&t.push(s)}return Promise.all(t).then((function(e){return{data:Object(l.flatten)(e)}}))},t.prototype.testDatasource=function(){var e=this;return new Promise((function(t,r){return s(e,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,new f(this.instanceSettings).getSubscriptions()];case 1:return(e=n.sent())&&e.length>0?t({message:"Successfully Connected Azure Monitor",status:"success"}):r({message:"Failed to retrieve subscriptions",status:"error"}),[3,3];case 2:return n.sent(),r({message:"Failed to Connect",status:"error"}),[3,3];case 3:return[2]}}))}))}))},t.prototype.metricFindQuery=function(e){if(!e)return Promise.resolve([]);var t=this.azureResourceGraphDatasource.metricFindQuery(e);return t||Promise.resolve([])},t}(n.DataSourceApi),ee=Y,te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCloudNameChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options,i=o(o({},a.jsonData),{cloudName:e.value});n(o(o({},a),{jsonData:i}))},t.onTenantIdChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options,i=o(o({},a.jsonData),{tenantId:e.target.value});n(o(o({},a),{jsonData:i}))},t.onClientIdChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options,i=o(o({},a.jsonData),{clientId:e.target.value});n(o(o({},a),{jsonData:i}))},t.onClientSecretChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options;n(o(o({},a),{secureJsonData:{clientSecret:e.target.value}}))},t.onResetclientSecret=function(){var e=t.props,r=e.onOptionsChange,n=e.options;r(o(o({},n),{secureJsonFields:o(o({},n.secureJsonFields),{clientSecret:!1}),secureJsonData:o(o({},n.secureJsonData),{clientSecret:""})}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.options,t=e.secureJsonData||{};e.jsonData.cloudName=e.jsonData.cloudName||"azuremonitor";var r=e.jsonData,n=e.secureJsonFields;return b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(A.FormLabel,{className:"width-10",tooltip:"Choose an Azure Cloud Type"},"Cloud Type"),b.a.createElement(A.Select,{className:"width-24",value:ee.find((function(e){return e.value===r.cloudName})),options:ee,defaultValue:r.cloudName,onChange:this.onCloudNameChange})),b.a.createElement("div",{className:"gf-form"},b.a.createElement(A.FormField,{label:"Tenant ID",labelWidth:10,inputWidth:24,onChange:this.onTenantIdChange,value:r.tenantId||"",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",tooltip:"Tenant ID"})),b.a.createElement("div",{className:"gf-form"},b.a.createElement(A.FormField,{label:"Client ID",labelWidth:10,inputWidth:24,onChange:this.onClientIdChange,value:r.clientId||"",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",tooltip:"Client ID"})),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(A.SecretFormField,{isConfigured:n&&n.clientSecret,value:t.clientSecret||"",label:"API Key",placeholder:"Client Secret",labelWidth:10,inputWidth:24,onReset:this.onResetclientSecret,onChange:this.onClientSecretChange}))))},t}(C.PureComponent),re=H,ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onServiceTypeChange=function(e){var r=t.props,n=r.query;(0,r.onChange)(o(o({},n),{queryType:e.value}))},t}return i(t,e),t.prototype.render=function(){var e,t=Object(l.defaults)(this.props.query,{azureResourceGraph:Object(l.defaults)(this.props.query.azureResourceGraph,w),azureAppInsights:Object(l.defaults)(this.props.query.azureAppInsights,q),azureLogAnalytics:Object(l.defaults)(this.props.query.azureAppInsights,D),azureCostAnalysis:Object(l.defaults)(this.props.query.azureCostAnalysis,$)});switch(t.queryType){case"Azure Resource Graph":e=b.a.createElement(N,{onChange:this.props.onChange,query:t,datasource:this.props.datasource});break;case"Azure Application Insights":e=b.a.createElement(X,{onChange:this.props.onChange,query:t,datasource:this.props.datasource});break;case"Azure Log Analytics":e=b.a.createElement(T,{onChange:this.props.onChange,query:t,datasource:this.props.datasource});break;case"Azure Cost Analysis":e=b.a.createElement(U,{onChange:this.props.onChange,query:t,datasource:this.props.datasource})}return b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(A.FormLabel,{className:"width-12",tooltip:"Service Type"},"Service"),b.a.createElement(A.Select,{className:"width-24",value:re.find((function(e){return e.value===t.queryType})),options:re,defaultValue:t.queryType,onChange:this.onServiceTypeChange}))),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},e)))},t}(C.PureComponent);r.d(t,"plugin",(function(){return ae}));var ae=new n.DataSourcePlugin(Z).setConfigEditor(te).setQueryEditor(ne)}])}));